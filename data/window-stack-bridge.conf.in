description "Window Stack Bridge"

start on started dbus
stop on desktop-end

pre-start script
        if [ -z $DBUS_SESSION_BUS_ADDRESS ]; then
                echo "Working around missing DBUS_SESSION_BUS_ADDRESS variable"
                printf "DuplicateSignature\0DBusSessionAddressNotSet" | /usr/share/apport/recoverable_problem -p `pidof -s -o 1 init` 
                . "$XDG_RUNTIME_DIR/dbus-session"
                initctl set-env "DBUS_SESSION_BUS_ADDRESS=$DBUS_SESSION_BUS_ADDRESS"
        fi
end script

exec @pkglibexecdir@/window-stack-bridge
